# 🎨 ColoSwitch - アイコン色変換ツール（透明PNG一部対応）

**ColoSwitch** は、画像から代表的な色を抽出し、選んだ色を別の色に一括で置き換える Gradio ベースの画像変換ツールです。  
PNG形式（透明背景付き）にも一部対応していますが、**完全な透明処理は今後対応予定です**。

---

## ✅ 特徴

- 画像から代表色（最大10色）を抽出
- 任意の色に置換可能（ColorPicker 対応）
- 色の近さをユークリッド距離で判定
- 類似色の許容範囲をスライダーで調整可能
- 変換後画像を表示・PNG形式でダウンロード可能
- Webベースでローカル実行可（Gradio）

---

## ⚠️ 現在の制限事項（2025年8月時点）

- **完全に透明なピクセル（α=0）**が多く含まれる画像では、抽出や変換に誤差が生じる可能性があります
- 抽出処理では透明ピクセルをある程度除外しますが、**透明背景に埋もれた色が混入することがあります**
- 完全な透明ピクセル除外処理は、今後のアップデートで対応予定です

---

## 🚀 起動方法

```bash
git clone <このリポジトリのURL>
cd <プロジェクトディレクトリ>
pip install -r requirements.txt
python app.py
```
起動後、ブラウザが自動で開き、アプリを操作できます（通常 http://localhost:7860）。

## 🧪 使い方
### 画像をアップロードする
1. 「① 画像をアップロード」エリアに画像をドラッグ＆ドロップ、またはクリックで選択
2. PNG形式推奨。透明部分が多すぎる画像は非推奨

### 色を抽出する
- 「② 色を抽出して選択肢に反映」をクリック

- 抽出された代表色がドロップダウンに表示される

### 変えたい色を選ぶ
- 「③ 変えたい色」から対象の色を選択

### 変更後の色を指定する
- 「④ 変更後の色」で ColorPicker を使って任意の色を選択

### 類似色の許容範囲を調整する
- 「⑤ 類似色の許容範囲」スライダーで近似色の範囲を調整（目安：30〜60）

### 色を変換する
「🚀 色を変換」をクリックして処理を実行

### 結果を保存する
- 変換後の画像が表示され、「PNGダウンロード」リンクから保存可能

## 💡 補足ヒント
- 色指定は #rrggbb 形式に加えて、rgba(r,g,b,a) にも対応（内部で自動変換）
- 類似色の検出にはユークリッド距離を採用しており、見た目に近い色も一括変換可能
- 処理がうまくいかない場合は、許容範囲を調整して試してみてください

## 📦 使用ライブラリ
```
gradio
pillowS
numpy
```

---

## 💡 補足ヒント

* 色指定は `#rrggbb` 形式に加えて、`rgba(r,g,b,a)` にも対応（内部で自動変換）
* 類似色の検出にはユークリッド距離を採用しており、見た目に近い色も一括変換可能
* 処理がうまくいかない場合は、許容範囲を調整して試してみてください

---

## 📦 使用ライブラリ

* `gradio`
* `pillow`
* `numpy`

---

## 📂 ファイル構成

```
.
├── app.py            # メインアプリケーション
├── requirements.txt  # 必要ライブラリ定義
└── README.md         # このファイル
```

---

## 🔧 今後の改善予定

* 完全な透明ピクセルの除外精度向上
* 背景色との合成を考慮した抽出アルゴリズム
* 変換後の比較表示（Before / After）
* スマホでも使いやすいUI設計